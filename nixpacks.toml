[phases.setup]
# Use APT to install Tesseract and language packages
aptPkgs = [
    "python3.10-dev",
    "build-essential",
    "libpq-dev",
    "curl",
    "wget",
    "libtesseract-dev",
    "tesseract-ocr-eng", # English language pack
    "tesseract-ocr-nld", # Dutch language pack
    "tesseract-ocr-spa", # Spanish language pack
    "tesseract-ocr-por", # Portuguese language pack
    "tesseract-ocr-fra"  # French language pack
]

[phases.install]
# Virtual environment setup and package installation
cmds = [
    "python3.10 -m venv /opt/venv",
    ". /opt/venv/bin/activate",
    "pip install --upgrade pip",
    "pip install wheel setuptools",
    "pip install -r requirements.txt"
]

[phases.build]
# Collect static files and run migrations
cmds = [
    ". /opt/venv/bin/activate",
    "python manage.py migrate",
    "python manage.py collectstatic --noinput"
]

[start]
# Start the Django app with Gunicorn
cmd = ". /opt/venv/bin/activate && gunicorn SplikamiProject.wsgi:application --bind 0.0.0.0:$PORT --workers 3 --timeout 120"

[variables]
# Environment variables for the application
PYTHONUNBUFFERED = "1"
PYTHONPATH = "/app"
PATH = "/opt/venv/bin:$PATH"
LANG = "C.UTF-8"
LC_ALL = "C.UTF-8"
